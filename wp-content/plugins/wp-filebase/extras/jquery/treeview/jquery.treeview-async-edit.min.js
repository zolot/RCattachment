!function(a){a.extend(a.fn,{swapClass:function(a,e){var l=this.filter("."+a);return this.filter("."+e).removeClass(e).addClass(a),l.removeClass(a).addClass(e),this},replaceClass:function(a,e){return this.filter("."+a).removeClass(a).addClass(e).end()},hoverClass:function(e){return e=e||"hover",this.hover(function(){a(this).addClass(e)},function(){a(this).removeClass(e)})},heightToggle:function(a,e){a?this.animate({height:"toggle"},a,e):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),e&&e.apply(this,arguments)})},heightHide:function(a,e){a?this.animate({height:"hide"},a,e):(this.hide(),e&&this.each(e))},prepareBranches:function(a){return a.prerendered||(this.filter(":last-child:not(ul)").addClass(e.last),this.filter((a.collapsed?"":"."+e.closed)+":not(."+e.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(l,s){if(this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(e){s.apply(a(this).next())}).add(a("a",this)).hoverClass(),!l.prerendered){this.filter(":has(>ul:hidden)").addClass(e.expandable).replaceClass(e.last,e.lastExpandable),this.not(":has(>ul:hidden)").addClass(e.collapsable).replaceClass(e.last,e.lastCollapsable);var t=this.find("div."+e.hitarea);t.length||(t=this.prepend('<div class="'+e.hitarea+'"/>').find("div."+e.hitarea)),t.removeClass().addClass(e.hitarea).each(function(){var e="";a.each(a(this).parent().attr("class").split(" "),function(){e+=this+"-hitarea "}),a(this).addClass(e)})}this.find("div."+e.hitarea).click(s)},treeview:function(l){function s(l,s){function i(s){return function(){return t.apply(a("div."+e.hitarea,l).filter(function(){return s?a(this).parent("."+s).length:!0})),!1}}a("a:eq(0)",s).click(i(e.collapsable)),a("a:eq(1)",s).click(i(e.expandable)),a("a:eq(2)",s).click(i())}function t(){a(this).parent().find(">.hitarea").swapClass(e.collapsableHitarea,e.expandableHitarea).swapClass(e.lastCollapsableHitarea,e.lastExpandableHitarea).end().swapClass(e.collapsable,e.expandable).swapClass(e.lastCollapsable,e.lastExpandable).find(">ul").heightToggle(l.animated,l.toggle),l.unique&&a(this).parent().siblings().find(">.hitarea").replaceClass(e.collapsableHitarea,e.expandableHitarea).replaceClass(e.lastCollapsableHitarea,e.lastExpandableHitarea).end().replaceClass(e.collapsable,e.expandable).replaceClass(e.lastCollapsable,e.lastExpandable).find(">ul").heightHide(l.animated,l.toggle)}function i(){var e=[];d.each(function(l,s){e[l]=a(s).is(":has(>ul:visible)")?1:0}),a.cookie(l.cookieId,e.join(""),l.cookieOptions)}function n(){var e=a.cookie(l.cookieId);if(e){var s=e.split("");d.each(function(e,l){a(l).find(">ul")[parseInt(s[e])?"show":"hide"]()})}}if(l=a.extend({cookieId:"treeview"},l),l.toggle){var r=l.toggle;l.toggle=function(){return r.apply(a(this).parent()[0],arguments)}}this.data("toggler",t),this.addClass("treeview");var d=this.find("li").prepareBranches(l);switch(l.persist){case"cookie":var o=l.toggle;l.toggle=function(){i(),o&&o.apply(this,arguments)},n();break;case"location":var h=this.find("a").filter(function(){return 0==location.href.toLowerCase().indexOf(this.href.toLowerCase())});if(h.length){var p=h.addClass("selected").parents("ul, li").add(h.next()).show();l.prerendered&&p.filter("li").swapClass(e.collapsable,e.expandable).swapClass(e.lastCollapsable,e.lastExpandable).find(">.hitarea").swapClass(e.collapsableHitarea,e.expandableHitarea).swapClass(e.lastCollapsableHitarea,e.lastExpandableHitarea)}}return d.applyClasses(l,t),l.control&&(s(this,l.control),a(l.control).show()),this}}),a.treeview={};var e=a.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"}}(jQuery),function(a){var e=a.treeview.classes,l=a.fn.treeview;a.fn.treeview=function(s){return s=a.extend({},s),s.add?this.trigger("add",[s.add]):s.remove?this.trigger("remove",[s.remove]):l.apply(this,arguments).bind("add",function(l,t){a(t).prev().removeClass(e.last).removeClass(e.lastCollapsable).removeClass(e.lastExpandable).find(">.hitarea").removeClass(e.lastCollapsableHitarea).removeClass(e.lastExpandableHitarea),a(t).find("li").andSelf().prepareBranches(s).applyClasses(s,a(this).data("toggler"))}).bind("remove",function(l,s){var t=a(s).prev(),i=a(s).parent();a(s).remove(),t.filter(":last-child").addClass(e.last).filter("."+e.expandable).replaceClass(e.last,e.lastExpandable).end().find(">.hitarea").replaceClass(e.expandableHitarea,e.lastExpandableHitarea).end().filter("."+e.collapsable).replaceClass(e.last,e.lastCollapsable).end().find(">.hitarea").replaceClass(e.collapsableHitarea,e.lastCollapsableHitarea),i.is(":not(:has(>))")&&i[0]!=this&&(i.parent().removeClass(e.collapsable).removeClass(e.expandable),i.siblings(".hitarea").andSelf().remove())})}}(jQuery),function(a){function e(e,l,s,t){function i(e){var l=a("<li/>").attr("id",this.id||"").html("<span>"+this.text+"</span>").appendTo(e);if(this.classes&&l.children("span").addClass(this.classes),this.expanded&&l.addClass("open"),this.hasChildren||this.children&&this.children.length){var s=a("<ul/>").appendTo(l);this.hasChildren&&(l.addClass("hasChildren"),i.call({classes:"placeholder",text:"&nbsp;",children:[]},s)),this.children&&this.children.length&&a.each(this.children,i,[s])}}a.ajax(a.extend(!0,{url:e.url,dataType:"json",data:{root:l},success:function(e){s.empty(),a.each(e,i,[s]),a(t).treeview({add:s})}},e.ajax))}var l=a.fn.treeview;a.fn.treeview=function(s){if(!s.url)return l.apply(this,arguments);s.root||(s.root="source");var t=this;t.children().size()||e(s,s.root,this,t);var i=s.toggle;return l.call(this,a.extend({},s,{collapsed:!0,toggle:function(){var l=a(this);if(l.hasClass("hasChildren")){var n=l.removeClass("hasChildren").find("ul").first();e(s,this.id,n,t)}i&&i.apply(this,arguments)}}))}}(jQuery);